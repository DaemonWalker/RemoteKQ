# 远程打卡工具

## 原理

### 登录部分
1. 在登录的时候客户端会生成两个字符串，一个是DeviceID，一个是CheckCodeID，这两个字符串用来确认一个设备，我使用了GUID.CreateNew()来模拟生成
2. 利用生成的CheckCodeID访问相关的接口获取验证码。
3. 根据用户输入的用户名密码验证码POST相关接口来模拟登录。
4. 登陆成功会返回一个cookie，内容为rememberMe=value。这个cookie要全程使用，用于确认用户身份。涉及到打卡的POST、GET操作基本都需要这个Cookie。
5. 由于OA和打卡使用了两个不同的域名，为了防止出错，我将4中的cookie复制一份并将域设置为打卡接口所在的域。

### 打卡部分
1.地址部分使用了百度地图的API，根据当前位置获取500米范围内的12个景点，然后选取景点名称拼接成一个字符串。字符串格式为"省名市名景点名"。
2.首先访问相关接口获取打卡地址的url。
3.访问这个url会得到打卡页面，这时服务器会分配一个JSESSIONID。
4.将位置字符串和照片信息（暂时未实现）拼接成JSON，POST给相关接口即可实现打卡

## 程序使用说明
1. 程序需要.Net Framework 4.5运行时
2. 第一次运行请按如下顺序操作：登录=>点击链接在相关页面找到想要打卡地点的坐标=>然后选择打卡的位置=>点击“打卡一次”，查看右侧是否有打卡的信息显示，有则为成功。
如果成功即可设置自动打卡时间，点击自动打卡即可。
如果不成功请关闭程序重新操作一遍。
3. 验证看不清点击验证码即可进行刷新。
4. 程序数据文件存储在 %Appdata%/NeusoftKQ/save.json，删除该文件可使程序强制初始化。
5. 修改UserAgent可以更改模拟机型，百度一下手机UserAgent即可。

## 其他打卡可能
1. 使用Fiddler修改Http包来更改打卡位置信息
2. 使用DNS污染，将api.map.baidu.com重定向到相关网站并返回编辑过的位置数据
3. 以上两种我都测试成功过，且安全性比较高，因为是真实手机操作，不存在风险，但是不自动。

**此程序仅供学习交流用，如使用产生不良后果作者概不负责**
